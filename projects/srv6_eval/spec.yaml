
nodes:
  - name: R1
    image: tmp
    interfaces:
      - { name: net0, type: direct, args: R1#net0 }
      - { name: net1, type: direct, args: R2#net0 }
      - { name: net2, type: direct, args: R3#net0 }
  - name: R2
    image: tmp
    interfaces:
      - { name: net0, type: direct, args: R1#net0 }
  - name: R3
    image: tmp
    interfaces:
      - { name: net0, type: direct, args: R1#net1 }
  - name: R4
    image: tmp
    interfaces:
      - { name: net0, type: direct, args: R1#net2 }

node_configs:
  - name: R1
    cmds:
      - cmd: sysctl -w 'net.ipv6.conf.all.forwarding=1'
      - cmd: sysctl -w 'net.ipv6.conf.all.disable_ipv6=0'
      - cmd: sysctl -w 'net.ipv6.conf.all.seg6_enabled=1'
      - cmd: sysctl -w 'net.ipv6.conf.default.forwarding=1'
      - cmd: sysctl -w 'net.ipv6.conf.default.disable_ipv6=0'
      - cmd: sysctl -w 'net.ipv6.conf.default.seg6_enabled=1'
      - cmd: sysctl -w 'net.ipv6.conf.net0.seg6_enabled=1'
      - cmd: sysctl -w 'net.ipv6.conf.net1.seg6_enabled=1'
      - cmd: sysctl -w 'net.ipv6.conf.net2.seg6_enabled=1'
      - cmd: ip -6 addr add fd00::1/128 dev lo
      - cmd: ip -6 addr add fc00:a::1/64 dev net0
      - cmd: ip -6 addr add fc00:b::1/64 dev net1
      - cmd: ip -6 addr add fc00:c::1/64 dev net2
      - cmd: ip -6 rout add fd00::2/128 via fc00:a::2
      - cmd: ip -6 rout add fd00::3/128 via fc00:b::2
      - cmd: ip -6 rout add fd00::4/128 via fc00:c::2
  - name: R2
    cmds:
      - cmd: sysctl -w 'net.ipv6.conf.all.forwarding=1'
      - cmd: sysctl -w 'net.ipv6.conf.all.disable_ipv6=0'
      - cmd: sysctl -w 'net.ipv6.conf.all.seg6_enabled=1'
      - cmd: sysctl -w 'net.ipv6.conf.default.forwarding=1'
      - cmd: sysctl -w 'net.ipv6.conf.default.disable_ipv6=0'
      - cmd: sysctl -w 'net.ipv6.conf.default.seg6_enabled=1'
      - cmd: sysctl -w 'net.ipv6.conf.net0.seg6_enabled=1'
      - cmd: ip -6 addr add fd00::2/128 dev lo
      - cmd: ip -6 addr add fc00:a::2/64 dev net0
      - cmd: ip -6 rout add fd00::1/128 via fc00:a::1
      - cmd: ip -6 rout add fd00::3/128 via fc00:a::1
      - cmd: ip -6 rout add fd00::4/128 via fc00:a::1
  - name: R3
    cmds:
      - cmd: sysctl -w 'net.ipv6.conf.all.forwarding=1'
      - cmd: sysctl -w 'net.ipv6.conf.all.disable_ipv6=0'
      - cmd: sysctl -w 'net.ipv6.conf.all.seg6_enabled=1'
      - cmd: sysctl -w 'net.ipv6.conf.default.forwarding=1'
      - cmd: sysctl -w 'net.ipv6.conf.default.disable_ipv6=0'
      - cmd: sysctl -w 'net.ipv6.conf.default.seg6_enabled=1'
      - cmd: sysctl -w 'net.ipv6.conf.net0.seg6_enabled=1'
      - cmd: ip -6 addr add fd00::3/128 dev lo
      - cmd: ip -6 addr add fc00:b::2/64 dev net0
      - cmd: ip -6 rout add fd00::1/128 via fc00:b::1
      - cmd: ip -6 rout add fd00::2/128 via fc00:b::1
      - cmd: ip -6 rout add fd00::4/128 via fc00:b::1
  - name: R4
    cmds:
      - cmd: sysctl -w 'net.ipv6.conf.all.forwarding=1'
      - cmd: sysctl -w 'net.ipv6.conf.all.disable_ipv6=0'
      - cmd: sysctl -w 'net.ipv6.conf.all.seg6_enabled=1'
      - cmd: sysctl -w 'net.ipv6.conf.default.forwarding=1'
      - cmd: sysctl -w 'net.ipv6.conf.default.disable_ipv6=0'
      - cmd: sysctl -w 'net.ipv6.conf.default.seg6_enabled=1'
      - cmd: sysctl -w 'net.ipv6.conf.net0.seg6_enabled=1'
      - cmd: ip -6 addr add fd00::4/128 dev lo
      - cmd: ip -6 addr add fc00:c::2/64 dev net0
      - cmd: ip -6 rout add fd00::1/128 via fc00:c::1
      - cmd: ip -6 rout add fd00::2/128 via fc00:c::1
      - cmd: ip -6 rout add fd00::3/128 via fc00:c::1

test:
  - name: p2p
    cmds:
      - cmd: docker exec R1 ping6 -c2 fc00:a::1
      - cmd: docker exec R1 ping6 -c2 fc00:a::2
      - cmd: docker exec R1 ping6 -c2 fc00:b::1
      - cmd: docker exec R1 ping6 -c2 fc00:b::2
      - cmd: docker exec R1 ping6 -c2 fc00:c::1
      - cmd: docker exec R1 ping6 -c2 fc00:c::2
      - cmd: docker exec R2 ping6 -c2 fc00:a::1
      - cmd: docker exec R2 ping6 -c2 fc00:a::2
      - cmd: docker exec R3 ping6 -c2 fc00:b::1
      - cmd: docker exec R3 ping6 -c2 fc00:b::2
      - cmd: docker exec R4 ping6 -c2 fc00:c::1
      - cmd: docker exec R4 ping6 -c2 fc00:c::2
  - name: lo
    cmds:
      - cmd: docker exec R1 ping6 -c2 fd00::1 -I fd00::1
      - cmd: docker exec R1 ping6 -c2 fd00::2 -I fd00::1
      - cmd: docker exec R1 ping6 -c2 fd00::3 -I fd00::1
      - cmd: docker exec R1 ping6 -c2 fd00::4 -I fd00::1
      - cmd: docker exec R2 ping6 -c2 fd00::1 -I fd00::2
      - cmd: docker exec R2 ping6 -c2 fd00::2 -I fd00::2
      - cmd: docker exec R2 ping6 -c2 fd00::3 -I fd00::2
      - cmd: docker exec R2 ping6 -c2 fd00::4 -I fd00::2
      - cmd: docker exec R3 ping6 -c2 fd00::1 -I fd00::3
      - cmd: docker exec R3 ping6 -c2 fd00::2 -I fd00::3
      - cmd: docker exec R3 ping6 -c2 fd00::3 -I fd00::3
      - cmd: docker exec R3 ping6 -c2 fd00::4 -I fd00::3
      - cmd: docker exec R4 ping6 -c2 fd00::1 -I fd00::4
      - cmd: docker exec R4 ping6 -c2 fd00::2 -I fd00::4
      - cmd: docker exec R4 ping6 -c2 fd00::3 -I fd00::4
      - cmd: docker exec R4 ping6 -c2 fd00::4 -I fd00::4

